--[[
=====================================================
GM指令汇总文档
=====================================================

项目名称: Prison Game
版本: V1.2
更新日期: 2025-10-29

=====================================================
使用说明
=====================================================

1. 所有GM命令通过游戏内聊天输入
2. 命令以"/"开头
3. 参数用空格分隔
4. 当前测试期间所有玩家都可以使用GM命令

=====================================================
GM指令列表
=====================================================

【1. 帮助命令】
----------------------------------------------------
命令: /help
说明: 显示所有可用命令的帮助信息
参数: 无
用法: /help


【2. 兵种相关命令】
----------------------------------------------------

命令: /unitlist
说明: 显示所有可用的兵种ID和详细信息
参数: 无
用法: /unitlist
示例输出:
    可用的兵种列表:
      - Noob (等级1, Melee, 100金币)
      - Rookie (等级1, Melee, 200金币)

----------------------------------------------------

命令: /addunit <unitId> [count]
说明: 添加指定兵种到背包
参数:
    unitId  - 兵种ID(必填)，可用值: Noob, Rookie
    count   - 数量(可选)，默认1，范围1-100
用法示例:
    /addunit Noob           # 添加1个Noob
    /addunit Noob 5         # 添加5个Noob
    /addunit Rookie 3       # 添加3个Rookie
成功输出:
    成功添加 5 个 Noob
    玩家 XXX 的背包 (共5个兵种):
      - Noob x5

----------------------------------------------------

命令: /listunits
说明: 查看当前玩家背包中的所有兵种
参数: 无
用法: /listunits
示例输出:
    玩家 PlayerName 的背包 (共8个兵种):
      - Noob x5
      - Rookie x3

----------------------------------------------------

命令: /clearunits
说明: 清空背包中的所有兵种
参数: 无
用法: /clearunits
警告: 此操作不可恢复！
输出: 背包已清空


【4. 放置相关命令 - V1.2新增】
----------------------------------------------------

命令: /testplace <unitId>
说明: 快速测试放置功能，自动添加兵种并触发放置
参数:
    unitId - 兵种ID(必填)，可用值: Noob, Rookie
用法示例:
    /testplace Noob         # 测试放置Noob
    /testplace Rookie       # 测试放置Rookie
成功输出:
    已添加 Noob 并准备放置
    请通过背包选择兵种进行放置

----------------------------------------------------

命令: /clearplaced
说明: 清除所有已放置的兵种
参数: 无
用法: /clearplaced
输出: 已清除所有已放置的兵种

----------------------------------------------------

命令: /listplaced
说明: 查看当前已放置的兵种列表
参数: 无
用法: /listplaced
示例输出:
    已放置的兵种 (共3个):
      - Noob (位置: 10, 5, 15)
      - Rookie (位置: 12, 5, 18)
      - Noob (位置: 8, 5, 20)


【5. 货币相关命令】
----------------------------------------------------

命令: /addcoins <amount>
说明: 添加或扣除金币
参数:
    amount - 金币数量(必填)，正数添加，负数扣除
用法示例:
    /addcoins 1000          # 添加1000金币
    /addcoins 5000          # 添加5000金币
    /addcoins -500          # 扣除500金币
成功输出:
    成功添加 1000 金币,当前金币: 1100


=====================================================
快速测试流程
=====================================================

【新手测试流程】
1. /help                    # 查看所有命令
2. /unitlist                # 查看可用兵种
3. /addunit Noob 3          # 添加3个Noob
4. /addunit Rookie 2        # 添加2个Rookie
5. /listunits               # 查看背包
6. 按B键打开背包，点击兵种进行放置测试  # V1.2新增
7. /listplaced              # 查看已放置的兵种 V1.2新增
8. /addcoins 10000          # 添加10000金币

【完整功能测试】
1. /addunit Noob 10         # 批量添加测试
2. /listunits               # 验证数量
3. 打开背包测试放置功能      # V1.2新增
4. /listplaced              # 验证放置 V1.2新增
5. /clearplaced             # 清除已放置 V1.2新增
6. /clearunits              # 清空测试
7. /listunits               # 验证清空
8. /addunit InvalidUnit     # 测试错误处理


=====================================================
当前可用兵种配置
=====================================================

【Noob】
- ID: Noob
- 名称: Noob
- 类型: 近战 (Melee)
- 等级: 1级
- 价格: 100金币
- 占地: 1格
- 描述: 最基础的近战单位

【Rookie】
- ID: Rookie
- 名称: Rookie
- 类型: 近战 (Melee)
- 等级: 1级
- 价格: 200金币
- 占地: 1格
- 描述: 进阶的近战单位


=====================================================
常见错误及解决方案
=====================================================

【错误1】命令无响应
原因: 聊天功能未正常工作或GM系统未初始化
解决:
  1. 检查Output窗口是否有错误
  2. 确认MainServer已正确加载GMCommandSystem
  3. 重启游戏测试

【错误2】"无效的兵种ID"
原因: 输入的兵种ID不存在或拼写错误
解决: 使用 /unitlist 查看所有可用的兵种ID
注意: 兵种ID区分大小写！

【错误3】"数量必须在1-100之间"
原因: 添加兵种的数量超出限制
解决: 单次添加数量不要超过100

【错误4】背包数据丢失
原因: 当前版本数据仅存储在内存中
说明: 玩家离开或重连后数据会清空，这是正常现象
      后续版本会实现DataStore持久化


=====================================================
权限管理说明
=====================================================

【当前权限设置】
- 权限检查: 已禁用
- 所有玩家: 可使用所有GM命令
- 用途: 方便开发测试

【正式环境配置】
如需启用权限限制，修改 GMCommandSystem.lua:

1. 设置权限开关
   ENABLE_PERMISSION_CHECK = true

2. 添加管理员ID
   GM_ADMIN_USER_IDS = {
       123456789,  -- 你的Roblox UserId
       987654321,  -- 其他管理员UserId
   }

3. 重启游戏生效


=====================================================
调试命令 (仅服务端控制台可用)
=====================================================

当 GameConfig.DEBUG_MODE = true 时，可在服务端控制台使用：

_G.DebugAddCoins("PlayerName", 1000)
    # 为指定玩家添加金币

_G.DebugGetPlayerData("PlayerName")
    # 查看玩家完整数据

_G.DebugGetHomeOccupancy()
    # 查看基地占用状态


=====================================================
版本更新记录
=====================================================

【V1.2】 2025-10-29
- 新增: /testplace 命令 - 快速测试兵种放置
- 新增: /clearplaced 命令 - 清除已放置的兵种
- 新增: /listplaced 命令 - 查看已放置的兵种
- 新增: 兵种放置系统 - 支持拖放兵种到IdleFloor
- 新增: 网格吸附功能 - 自动对齐到格子中心
- 新增: 边界限制功能 - 防止放置超出范围
- 新增: 高光预览功能 - 放置前显示绿色高光

【V1.1】 2025-10-28
- 新增: /unitlist 命令
- 新增: /addunit 命令
- 新增: /listunits 命令
- 新增: /clearunits 命令
- 新增: /addcoins 命令
- 新增: /help 命令

【V1.0】
- 基础货币系统
- 基地分配系统
- 玩家管理系统

关闭/打开测试背包:
  - 点击右上角X按钮关闭
  - 按F9打开控制台，输入 _G.ToggleBackpack() 重新打开


=====================================================
反馈与建议
=====================================================

如发现问题或有功能建议，请记录：
1. 使用的命令
2. 输入的参数
3. 预期结果 vs 实际结果
4. Output窗口的错误信息

=====================================================
文档结束
=====================================================
]]
